\documentclass[a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[margin=1in, footskip=0.25in]{geometry}

\usepackage{booktabs}
\usepackage{graphicx}
\graphicspath{../plots}

\usepackage{hyperref}
\usepackage[backend=bibtex, style=numeric, sorting=none]{biblatex}
\bibliography{references}

\usepackage[font=footnotesize,labelfont=bf]{caption}
\captionsetup{width=\linewidth}
\usepackage{subcaption}

\usepackage{listings}
\renewcommand{\lstlistingname}{Code}

\usepackage{xcolor}
\definecolor{backcolour}{RGB}{239,235,230}
\definecolor{lightgray}{gray}{0.7}
\lstdefinestyle{matlabcode}{
	language		=Matlab,
	backgroundcolor	=\color{backcolour},
	basicstyle		=\ttfamily\footnotesize,
	commentstyle	=\color{lightgray},
	numbers			=left,                    
	numbersep		=5pt,
	tabsize			=4,
	showstringspaces=false,
	frame			=leftline,
	captionpos 		= b
}
\lstset{style=matlabcode}

\usepackage{amsmath}
\usepackage{enumitem}


\begin{document}
	
	% ======================= start titlepage ==============================================
	
	\begin{titlepage}
		\begin{center}
			\Large Numerical Methods in Astrophysics \\
			\vspace{1cm}
			\huge{
				Project 3 \\
				\vspace{0.5cm}
				\textbf{Two Dimensional Random Walk,}\\
				\textbf{Circular Binary and} \\
				\textbf{Hypervelocity Stars} \\
				\vspace{1cm}
			}
			\Large \emph{Saksham Kaushal}
		\end{center}
	\end{titlepage}
	
	% =========================end titlepage ================================================
	
	\tableofcontents
	\newpage
	
	% ========================= Problem 1 ===================================================
	
	\part{Two Dimensional Random Walk} \label{problem1}
	
		% ------------------------------- Introduction --------------------------------------
		
		\section{Introduction} \label{1:introduction}
		
		A random walk is a process that describes the path of an object in a two dimensional plane consisting of successive random steps. In physics, these processes play an important role in study of polymers, Brownian motion, diffusion, etc. 
		
		% -------------------------------- Methods, Results ---------------------------------
		
		\section{Methods, Results and Discussions} \label{1:methods_results}
		
		\begin{figure} [h]
			\begin{subfigure} {.475\columnwidth}
				\includegraphics[width=\columnwidth]{../plots/1aa_randomwalk.png}
				\caption{Two dimensional random walk of a particle over 2000 time steps}
				\label{fig:1a}
			\end{subfigure}%
			\hfill
			\begin{subfigure} {.475\columnwidth}
				\includegraphics[width=\columnwidth]{../plots/1ab_randomwalk.png}
				\caption{Distribution of final coordinates of 2000 random walk particles}
				\label{fig:1b}
			\end{subfigure}
			
			\begin{subfigure} {.475\columnwidth}
				\includegraphics[width=\columnwidth]{../plots/1ac_hist_randomwalk.png}
				\caption{Number distribution with distance of \(5 \times 10^5\) random walk particles}
				\label{fig:1c}
			\end{subfigure}%
			\hfill
			\begin{subfigure} {.475\columnwidth}
				\includegraphics[width=\columnwidth]{../plots/1ad_hist_randomwalk.png}
				\caption{Theoretical estimates and observed distribution of \(10^5\) random walk points. The blue histogram represents the observed number distribution , while the red line is a plot of analytical estimates.}
				\label{fig:1d}
			\end{subfigure}
			\caption{Plotted results for problem 1.1A.}
			\label{fig:1}
		\end{figure}
		
		\begin{enumerate} [label*=\textbf{(\alph*)}]
			
			% ---------------------------------- (a) ---------------------------------------------
			
			\item 
				\subitem \textbf{Methods  --} 
					Random walk of a particle which is initially located at origin (0,0), is computed for 2000 time steps. At each time step, the object moves a distance, \(d=0.01\) units in a random direction which is mathematically represented using angle, \(\theta \in [0,2\pi]\), computed in the Matlab program with the help of inbuilt function, \texttt{rand()}. This function generates random number uniformly in the range \([0,1]\), therefore, multiplying the obtained random number by \(2\pi\) give us the random angle \(\theta\), in line 6 of the code \ref{code:1.1} Successive movements in the two dimensional plane are computed in lines 7 and 8 of code \ref{code:1.1}, which are enclosed in a \emph{for loop} defined in line 5, which repeats the process for each of the 2000 time steps.
					
					\begin{figure} [h]
						\lstinputlisting[caption=prob1aa.m - 2D random walk of a particle, label=code:1.1]{../problem1/prob1aa.m}
					\end{figure}
					
				\subitem \textbf{Results --} 
					The plot of two dimensional random walk of a particle obtained using Matlab code given in code \ref{code:1.1} is shown in figure \ref{fig:1a}.
				
				% \subitem \textbf{Discussion --}
			
			% ---------------------------------- (b) ---------------------------------------------
			
			\item 
				\subitem \textbf{Methods  --} 
					Random walk for 2000 time steps, like the one performed in previous part is performed for 2000 different particles. Accordingly, the crux of code \ref{code:1.1} is executed in a \emph{for loop}, 2000 times, i.e. once for each particle, as shown in line 4 of code \ref{code:1.2}. Instead of visualizing the complete path of random walk, this time only the final coordinates of the particle after finishing the random walk are considered and stored separately in lines 12 and 13 of code \ref{code:1.2}.   
					
					\begin{figure} [h]
						\lstinputlisting[caption=prob1ab.m - Scatter of final positions of 2000 2D random walks, label=code:1.2]{../problem1/prob1ab.m}
					\end{figure}
					
				\subitem \textbf{Results --} 
					A scatter plot of final positions after 2000 time steps, of 2000 particles undergoing two dimensional random walk is shown in figure \ref{fig:1b}. 
				
				% \subitem \textbf{Discussion --}
			
			% ---------------------------------- (c) ---------------------------------------------
			
			\item 
				\subitem \textbf{Methods  --} 
					Using elements from code \ref{code:1.2}, final positions of \(5 \times 10^{5}\) particles are computed. The functions \texttt{tic} and \texttt{toc} are used to compute the time elapsed in execution of the code. With the help of these functions, the total number of particles is chosen, based purely on estimate of the maximum computations that can be performed in feasible time. So, The initial 18 lines of code \ref{code:1.3} are essentially adopted from code \ref{code:1.2}, with an exception of line 17, where the modulus of displacement of a particle from origin is calculated. The following lines evaluate and plot the histogram of number distribution of particles with distance travelled. Using a bin width of \(dr=0.05\), binedges are computed and the histogram is plotted on line 24.\\
					An alternate method in which counts in each bin are calculated to produce the histogram, was used to confirm results, and is not shown in code \ref{code:1.3}. 
					
					\begin{figure} [h]
						\lstinputlisting[caption=prob1ac.m - Number distribution with distance of \(5 \times 10^5\) particles, label=code:1.3]{../problem1/prob1ac.m}
					\end{figure}
					
				\subitem \textbf{Results --}
					The histogram showing particle number distribution, \(N(r,r+\Delta r)\), of 500000 particles for \(\Delta r = 0.05\) is given in figure \ref{fig:1c}. 
				
				%\subitem \textbf{Discussion --}
				
			% ---------------------------------- (d) ---------------------------------------------
			
			\item 
				\subitem \textbf{Methods  --} 
					Initial lines of code \ref{code:1.4}, till line 27, are adopted from code \ref{code:1.3} and the value of \texttt{np} is set to \(10^5\), i.e. histogram is generated for \(10^5\) particles. Theoretically expected number distribution is then computed for each bin in lines 30-33, and the obtained curve is overlayed on the histogram. Analytically calculated number distribution of particles with distance is given by equation (3) of project notes as,
					\begin{equation}
						N(r,r+\Delta r) = N^{}_{p} \exp\left( -\frac{r^2_{}}{nd^2_{}} \right) \left\lbrace 1- \exp \left( - \frac{\Delta r (2r+\Delta r)}{nd^2_{}} \right) \right\rbrace ,
						\label{eq:number_distribution}
					\end{equation}
					where, \(N(r,r+\Delta r)\) is the number of particles that have eventually travelled an absolute value of displacement in the range \([r,r+\Delta r]\), \(N_p^{}\) is the total number of particles, \(n\) is the number of time steps and \(d\) is the jump size at each time step. This equation \ref{eq:number_distribution} is encoded in code \ref{code:1.4} in lines 31 and 32.
					\begin{figure} [h]
						\lstinputlisting[caption=(Part of) prob1ad.m - Analytical estimates and observed 	number distributions with distance of \(10^5\) particles, 
										label=code:1.4, firstline=28, firstnumber=28,
										lastline=35]{../problem1/prob1ad.m}
					\end{figure}
					
				\subitem \textbf{Results --} 
					The histogram for \(10^5\) particles is shown in figure \ref{fig:1d}. The analytical estimates is overlayed on the same plot. 
				
				\subitem \textbf{Discussion --}
					For a large number of particles, the observed number distribution seems to coincide well with the theoretical estimates, as seen in figure \ref{fig:1d}.
				
			% ---------------------------------- (e) ---------------------------------------------
			
			\item
				\subitem \textbf{Methods --}
					The number distribution of photons in this case is given by,
					\begin{equation}
						N(r) dr = 2 \pi r \rho (r) dr,
						\label{eq:photon_num_distribution}
					\end{equation}
					where, \(\rho (r)\) is the particle density distribution, given by,
					\begin{equation}
						\rho (r) = \frac{N_p^{}}{\pi n d^2_{}} \exp \left( - \frac{r^2_{}}{nd^2_{}} \right)
						\label{eq:photon_particle_density} 
					\end{equation}
					Substituting equation \ref{eq:photon_particle_density} in equation \ref{eq:photon_num_distribution}, we obtain,
					\[N(r)dr = \frac{2rN_p^{}}{nd^2_{}} \exp \left( - \frac{r^2_{}}{nd^2_{}} \right) dr.\]
					At peak number density, derivative of \(n\) with respect to displacement \(r\) equals zero. From this we obtain,
					\[\frac{dN}{dr} = \frac{2N_p^{}}{nd^2_{}} \frac{d}{dr} \left[ r \exp \left( - \frac{r^2_{}}{nd^2_{}} \right) \right] = 0 \]
					\[\Rightarrow \frac{2N_p}{nd^2_{}} \exp \left( - \frac{r^2_{}}{nd^2_{}} \right) \left[ 1- \frac{2r^2_{}}{nd^2_{}} \right] = 0 \]
					
					\begin{equation}
						\Rightarrow n = \frac{2r^2_{}}{d^2_{}}
						\label{eq:num_distribution_deriv1}
					\end{equation}
					
					Using value of \(r = R_\odot^{} = 7 \times 10^8_{}\) m and \(d=1\) mm \(=10^{-3}_{}\) m in equation \ref{eq:num_distribution_deriv1}, we get, number of time steps,
					
					\begin{equation}
						n = 9.8 \times 10^{23}_{}.
						\label{eq:num_distribution_value}
					\end{equation}
					
					Total distance travelled by the photon before reaching the surface is, \(s = \) number of time steps \(\times\) distance travelled in each time step, i.e.,
					
					\begin{equation}
						s = 9.8\times 10^{23}_{} \times 10^{-3} = 9.8 \times 10^{20} \text{m}.
					\end{equation}
					
					With photon travelling at speed of light, \(c\), the time elapsed is given by,
					
					\begin{equation}
					 	t = \frac{s}{c} \approx 3.267 \times 10^{12}_{} \text{sec} \approx 10^5 \text{years}
					 	\label{eq:final_t_estimate}
					\end{equation}
					
				\subitem \textbf{Discussion --}
					The rough estimate of time taken by photon considers an ideal case with several approximations. Despite that, the calculation gives us a reasonable order of magnitude estimate in equation \ref{eq:final_t_estimate}, which is quite close to the value of a few million years, usually obtained for a realistic case.
			
		\end{enumerate}

		% -------------------------------- Conclusions ------------------------------------------
		
		\section{Conclusions} \label{1:conclusions}
		
		

	
	% ========================= Problem 2 ===================================================
	
	\clearpage
	\setcounter{section}{0}
	\part{Circular Binary} \label{Problem2}
	
		% ------------------------------- Introduction --------------------------------------

		\section{Introduction} \label{2:introduction}

		% -------------------------------- Methods, Results ----------------------------------
		
		\section{Methods, Results and Discussions}
	
		\begin{enumerate} [label*=\textbf{(\alph*)}]
			
			% ---------------------------------- (a) ---------------------------------------------
			
			\item
				\subitem \textbf{Methods  --}
				The dimensionless masses and positions of primary and secondary stars are respectively given by,
				\begin{equation}
					\begin{gathered}
						\tilde{m}_p^{}=\frac{m_p^{}}{m} \text{ and } \tilde{m}_s^{}=\frac{m_s^{}}{m}, \\
						\tilde{x}_p^{}=\frac{x_p^{}}{a}, \text{ and } \tilde{x}_s^{}=\frac{x_s^{}}{a},
					\end{gathered}
					\label{eq:dimensionless_mass_pos}
				\end{equation}
				where, \(m\) and \(a\) are the total mass and separation of binary respectively. For a circular binary, the gravitational force experienced by each star equals the centripetal force on the star. Mathematically,
				\begin{equation}
					\begin{gathered}
						\frac{Gm_{s}^{}m_{p}^{}}{a^2_{}} = m_p^{} x_p^{} \omega^2_{} = m_s^{} x_s^{} \omega^2_{} , \\
						\Rightarrow x_s^{} = \frac{x_p^{} m_p^{}}{m_s^{}}.
					\end{gathered}
					\label{eq:secondary_pos}
				\end{equation}
				Total separation of binary is the sum of positions of primary and secondary stars with respect to their centre of mass, \textit{i.e.} 
				\begin{equation}
					x_p^{}+x_s^{} = a.
					\label{eq:binary_separation}
				\end{equation}
				Using equations \ref{eq:secondary_pos} and \ref{eq:binary_separation}, we obtain,
				\begin{equation}
					\begin{gathered}
						x_p + \frac{x_p m_p}{m_s} = a \\
						\Rightarrow x_p \left( \frac{m}{m_s}\right) = a \\
						\Rightarrow \tilde{x}_p = \tilde{m}_s 
					\end{gathered}
					\label{eq:xp_tilde}
				\end{equation}
				This relation gives us the relation for dimensionless position of primary star. Similarly, we can also obtain the relation for dimensionless position of secondary star as,
				\begin{equation}
					\begin{gathered}
						x_s + \frac{x_s m_s}{m_p} = a \\
						\Rightarrow \tilde{x}_s = \tilde{m}_p
					\end{gathered}
					\label{eq:xs_tilde}
				\end{equation}
				
				If we substitute the value of angular velocity, \(\omega =  v_p/r_p = v_s/r_s\), in equation \ref{eq:secondary_pos} for the two stars, we get,
				\begin{equation}
					\begin{gathered}
						\frac{G m_s m_p}{a^2} = \frac{m_p v_p^2}{x_p} = \frac{m_s v_s^2}{x_s} \\
						\Rightarrow \frac{v_p}{v_s} = \frac{m_s}{m_p}
					\end{gathered}
					\label{eq:gravity_centripetal}
				\end{equation}
				Multiplying both numerator and denominator of RHS by \(1/m\), we obtain,
				\begin{equation}
					\frac{v_p}{v_s} = \frac{\tilde{m}_s}{\tilde{m}_p}
					\label{eq:velocity_mass_relation}
				\end{equation}
				
				If we use the first relation of equation \ref{eq:gravity_centripetal}, we get,
				\begin{equation}
					\begin{gathered}
						\frac{G m_s m_p}{a^2} = \frac{m_p v_p^2}{x_p} \\
						\Rightarrow v_p^2 = \frac{G m_s x_p}{a^2} \\
						\Rightarrow v_p^2 = \frac{Gm}{a} \tilde{m}_s \tilde{x}_p = \frac{Gm}{a} \tilde{m}_s^2,
					\end{gathered}
				\end{equation}
				where, we have substituted values from equation set \ref{eq:dimensionless_mass_pos} and equation \ref{eq:xp_tilde}. In units of \(\sqrt{Gm/a}\), we obtain the value of dimensionless velocity of primary star as,
					\begin{equation}
						\tilde{v}_p = \tilde{m}_s
						\label{eq:primary_velocity}
					\end{equation}
				By using equations \ref{eq:gravity_centripetal} and \ref{eq:primary_velocity}, we get dimensionless velocity of secondary as,
					\begin{equation}
						\tilde{v}_s = \tilde{m}_p
						\label{eq:secondary_velocity}
					\end{equation}
				
				Given that angular velocity \(\omega = 2\pi / T\), where \(T\) is the period of the circular binary, we can find the dimensionless time by using equation \ref{eq:secondary_pos}, as,
				\begin{equation}
					\begin{gathered}
						\nonumber \frac{G m_s m_p}{a^2} = m_p x_p \omega^2 \\
						\Rightarrow \frac{G m_s}{a^2} = \frac{4 \pi^2 x_p}{T^2} \\
					\end{gathered}
				\end{equation}
				Using equations \ref{eq:dimensionless_mass_pos} and \ref{eq:xp_tilde}, we get,
				\begin{equation}
					\begin{gathered}
						\frac{G m_s}{a^3} = \frac{4 \pi^2 m_s}{T^2 m} \\
						\Rightarrow T = 2 \pi \sqrt{\frac{a^3}{Gm}}.
					\end{gathered}
				\end{equation}
				In units of \(\sqrt{a^3/Gm}\), we therefore derive dimensionless time of a circular binary as,
				\begin{equation}
					\tilde{T} = 2 \pi
					\label{eq:dimensionless_time}
				\end{equation}
				
				\subitem \textbf{Results  --}
				In the given scenario, the stars lie in x-y plane, with their centre of mass at origin. Primary star has initial coordinates \((-x_{px},0)\) while the secondary stars lies initially at \((x_{py},0)\).\\
				The stars rotate counter-clockwise, which gives us the velocity of primary star, \(-v_{py}\) and the velocity of secondary star, \(v_{sy}\).
				Using equations \ref{eq:xp_tilde}, \ref{eq:xs_tilde}, \ref{eq:primary_velocity} and \ref{eq:secondary_velocity}, the dimensionless values of initial conditions of the stars are summarized in table \ref{table:2_initial_conditions}.\\ The value of dimensionless time period of binary is derived in equation \ref{eq:dimensionless_time} as \(2 \pi\).
				
				\begin{table}
					\centering
					\begin{tabular} {c c c c}
						\toprule
						\textbf{Parameter} & \textbf{Value} & \textbf{Parameter} & \textbf{Value} \\
						(Primary Star) & & (Secondary star) & \\
						\midrule
						\(\tilde{x}_{px}\) & \(-\tilde{m}_s\) & \(\tilde{x}_{sx}\) & \(\tilde{m}_p\) \\
						\(\tilde{x}_{py}\) & 0 & \(\tilde{x}_{sy}\) & 0\\
						\(\tilde{v}_{px}\) & 0 & \(\tilde{v}_{sx}\) & 0 \\
						\(\tilde{v}_{py}\) & \(-\tilde{m}_s\) & \(\tilde{v}_{sy}\) & \(\tilde{m}_p\) \\
						\bottomrule
					\end{tabular}
				\caption{A summary of initial conditions for the simulation. All quantities are mentioned in dimensionless units, for a binary in x-y plane rotating counter-clockwise, with centre of mass at origin and primary star on the negative x-axis and secondary star on positive x-axis initially.}
				\label{table:2_initial_conditions}
				\end{table}
				
				%\subitem \textbf{Discussions  --}
				
			% ---------------------------------- (b) ---------------------------------------------
			
			\item
				\subitem \textbf{Methods  --}
				Given that,
				\begin{equation}
					\frac{m_p}{m_s} = 4
					\label{eq:masses_ratio}
				\end{equation}
				Adding 1 on both side, we get,
				\begin{equation}
					\begin{gathered}
						\nonumber \frac{m_p}{m_s} + 1 = 5 \\
						\Rightarrow \frac{m_p+m_s}{m_s} = \frac{m}{m_s} = 5
					\end{gathered}
				\end{equation}
				\begin{equation}
					\Rightarrow \tilde{m}_s = \frac{m_s}{m} = \frac{1}{5} = 0.2
					\label{eq:secondary_dimensionless_mass}
				\end{equation}
				
				Using equations \ref{eq:dimensionless_mass_pos}, \ref{eq:masses_ratio} and \ref{eq:secondary_dimensionless_mass}, we can obtain the dimensionless mass of primary star as,
				\begin{equation}
					\tilde{m_p} = 4 \times \tilde{m_s} = 0.8
					\label{eq:primary_dimensionless_mass}
				\end{equation} 
				
				\subitem \textbf{Results  --}
				Using relations mentioned in table \ref{table:2_initial_conditions}, the initial conditions for the circular binary are defined in Matlab file \textit{binary.m} a shown in lines 13--20 of code \ref{code:2.1}. Using equations \ref{eq:secondary_dimensionless_mass} and \ref{eq:primary_dimensionless_mass}, the values of dimensionless masses of two stars are assigned in lines 11 and 12 as \texttt{mp = 0.8} and \texttt{ms = 0.2}.\\				
				The value of \texttt{tmax} is set ot \(10\pi\). Since from equation \ref{eq:dimensionless_time}, it is known that the value of dimensionless time is \(2\pi\), this given value of \texttt{tmax} will allow simulation to sun for 5 orbits of the binary. 
				
				\begin{figure} [h] 
					\lstinputlisting[caption=binary.m - Initial conditions of circularly rotating binary for a simulation of five orbital rotations., label=code:2.1,
					firstline=7,firstnumber=9,
					lastline=19]{../problem2/binary.m}
				\end{figure}
				
%				\subitem \textbf{Discussions  --}
			
			\begin{figure} [h]
				\begin{subfigure} {.475\columnwidth}
					\includegraphics[width=\columnwidth]{../plots/2c_orbits.png}
					\caption{Trajectories of primary and secondary stars in a circular binary system over the first five rotations.}
					\label{fig:2c}
				\end{subfigure}
				\hfill
				\begin{subfigure} {.485\columnwidth}
					\includegraphics[width=\columnwidth]{../plots/2d_energies.png}
					\caption{Analytically estimated and numerically calculated evolution of orbital energy over five rotations. The lines are seen to overlap, indicating good agreement of theoretical expectations with numerical results.}
					\label{fig:2d}
				\end{subfigure}
				\caption{Plotted results for problem 2.}
				\label{fig:2}
			\end{figure}
		
			% ---------------------------------- (c) ---------------------------------------------
			
			\item
				\subitem \textbf{Methods  --}
				Executing the Matlab code resulted in creation of file named \emph{out}. This file is then used to plot the orbits of the two stars using the pre-existing program \emph{orbitplot.m}.
				
				\subitem \textbf{Results  --}
				The obtained plot, which shows the trajectories of the two stars over 5 rotations is shown in figure \ref{fig:2c}. 
				
				\subitem \textbf{Discussions  --}
				It can be observed that dimensionless orbital radii of primary and secondary stars are \(0.2\) and \(0.8\) respectively. The orbits are circular around the centre of mass lying at origin.
			
			% ---------------------------------- (d) ---------------------------------------------
			
			\item
				\subitem \textbf{Methods  --}
				The energy of binary star system is given by,
				\begin{equation}
					E = \frac{1}{2} m_p v_p^2 + \frac{1}{2} m_s v_s^2 - \frac{G m_p m_s}{r}
					\label{eq:binary_energy}
				\end{equation}
				
				From equation \ref{eq:gravity_centripetal}, we van obtain relations for velocities of primary and secondary stars at any positions in their orbits as,
				\begin{equation}
					\begin{gathered}
						\frac{G m_s m_p}{r^2} = \frac{m_p v_p^2}{x_p} = \frac{m_s v_s^2}{x_s} \\
						\Rightarrow v_p^2 = \frac{G m_s x_p}{r^2} \text{ and } v_s^2 = \frac{G m_p x_s}{r^2}
					\end{gathered}
				\end{equation}
				
				Substituting these values in equation \ref{eq:binary_energy} and using binary separation, \(r = a = x_p+x_s\) from equation \ref{eq:binary_separation}, we get
				\begin{equation}
					\begin{gathered}
						\begin{aligned}
							E &= \frac{G m_p m_s x_p}{2a^2} + \frac{G m_s m_p x_s}{2a^2} - \frac{G m_p m_s}{a} \\
							&= \frac{G m_p m_s}{2a} - \frac{G m_p m_s}{a}\\
							&= -\frac{G m_p m_s}{2a} 
						\end{aligned}
					\end{gathered}
				\end{equation}
				
				In units of \(Gm^2/a\), the dimensionless energy is given by,
				\begin{equation}
					\tilde{E} = \cfrac{-\cfrac{G m_p m_s}{2a}}{\cfrac{G m^2}{a}} = -\cfrac{\tilde{m}_p \tilde{m}_s}{2}.
					\label{eq:dimensionless_energy}
				\end{equation}
				
				\begin{figure}
					\lstinputlisting[caption=second code, label=code:2.2,
					firstline=4]{../problem2/energyplot.m}
				\end{figure}
				
				The values of \(m_p\), \(m_s\) and \emph{tmax} are assigned to variables \texttt{mp}, \texttt{ms} and \texttt{tmax} in lines 1-3 of code \ref{code:2.2}. The derived value of dimensionless energy is specified in line 7 of the code. The program in code \ref{code:2.2} plots the time evolution of numerically and analytically calculated energies of the binary.
				
				\subitem \textbf{Results  --}
				The plot generated using code \ref{code:2.2} is shown in figure \ref{fig:2d}. The analytically estimated value of energy of the binary is given by equation \ref{eq:dimensionless_energy}.
				
				\subitem \textbf{Discussions  --}
				From equation \ref{eq:dimensionless_energy} we can conclude that the dimensionless energy of binary star system is constant and less than zero. In this case, its value from equation \ref{eq:dimensionless_energy} turns out to be \(-0.08\). Figure \ref{fig:2d} shows that numerically obtained energy of the system is similar to analytically calculated energy, both showing no variation in value over time.
			
		\end{enumerate}


		% -------------------------------- Conclusions --------------------------------------

		\section{Conclusions} \label{2:conclusions}


	% ========================= Problem 3 ===================================================
	
	\clearpage
	\setcounter{section}{0}
	\part{Hypervelocity Stars} \label{Problem3}

		% ------------------------------- Introduction --------------------------------------

		\section{Introduction} \label{3:introduction}

		% -------------------------------- Methods, Results ----------------------------------
		
		\section{Methods, Results and Discussions}
		
			
			\begin{figure} [h]
				\begin{subfigure} {.5\columnwidth}
					\includegraphics[width=\columnwidth]{../plots/3a_orbits_equalaxes.png}
					\caption{3a}
					\label{fig:3a}
				\end{subfigure}
				\hfill
				\begin{subfigure} {.5\columnwidth}
					\includegraphics[width=\columnwidth]{../plots/3b_secondaryorbit.png}
					\caption{3b}
					\label{fig:3b}
				\end{subfigure}\\
				
				\begin{subfigure} {\columnwidth}
					\centering
					\includegraphics[width=.5\columnwidth]{../plots/3c_energy.png}
					\caption{3c}
					\label{fig:3c}
				\end{subfigure}
				\caption{Problem 3 - fig 1}
				\label{fig:3.1}
			\end{figure}
			
			\begin{figure}
				\begin{subfigure} {.5\columnwidth}
					\includegraphics[width=\columnwidth]{../plots/3d_orbitsdisruption_equalaxes.png}
					\caption{3da}
					\label{fig:3da}
				\end{subfigure}
				\hfill
				\begin{subfigure} {.5\columnwidth}
					\includegraphics[width=\columnwidth]{../plots/3d_secondaryorbitdisruption_equalaxes.png}
					\caption{3db}
					\label{fig:3db}
				\end{subfigure}\\
				
				\begin{subfigure} {\columnwidth}
					\centering
					\includegraphics[width=.5\columnwidth]{../plots/3d_energy.png}
					\caption{3dc}
					\label{fig:3dc}
				\end{subfigure}
				\caption{Problem 3 - fig 2}
				\label{fig:3.2}
			\end{figure}
			
			\begin{table}
				\centering
				\begin{tabular} {l l r r}
					\toprule
					\textbf{Quantity} & \textbf{Variable} & \textbf{D=3} & \textbf{D=0.1}\\
					\midrule
					\(t^{}_{0}\) & \texttt{t} & -19.9555 & -15.1290 \\
					\(x^{}_{p}\) & \texttt{x(1)}& -400.0000 & -980.0000 \\
					\(y^{}_{p}\) & \texttt{x(2)} & -917.3151 & -199.7975 \\
					\(v^{}_{px}\) & \texttt{x(3)} & 37.6166 & 44.6972 \\
					\(v^{}_{py}\) & \texttt{x(4)} & 24.4949 & 4.4721 \\
					\(x^{}_{s}\) & \texttt{x(5)} & -400.0000 & -980.0000 \\
					\(y^{}_{s}\) & \texttt{x(6)} & -916.3151 & -198.7975 \\
					\(v^{}_{sx}\) & \texttt{x(7)} & 36.6166 & 43.6972 \\
					\(v^{}_{sy}\) & \texttt{x(8)} & 24.4949 & 4.4721 \\
					\bottomrule
				\end{tabular}
				\caption{Table of variable values for two values of D}
				\label{table:3_dvalues}
			\end{table}
			
			\lstinputlisting[caption=code 1, label=code:3.initialc,
			firstline=5]{../problem3d/initialc.m}
			\lstinputlisting[caption=code 2, label=code:3.f]{../problem3d/f.m}
			
			
			\begin{enumerate} [label*=\textbf{(\alph*)}]
	
			% ---------------------------------- (a) ---------------------------------------------
	
				\item
					\subitem \textbf{Methods  --}
					\subitem \textbf{Results  --}
					\subitem \textbf{Discussions  --}
	
			% ---------------------------------- (b) ---------------------------------------------
	
				\item
					\subitem \textbf{Methods  --}
					\subitem \textbf{Results  --}
					\subitem \textbf{Discussions  --}
	
			% ---------------------------------- (c) ---------------------------------------------
	
				\item
					\subitem \textbf{Methods  --}
					\subitem \textbf{Results  --}
					\subitem \textbf{Discussions  --}
	
			% ---------------------------------- (d) ---------------------------------------------
	
				\item
					\subitem \textbf{Methods  --}
					\subitem \textbf{Results  --}
					\subitem \textbf{Discussions  --}
	
			\end{enumerate}


		% -------------------------------- Conclusions --------------------------------------

		\section{Conclusions} \label{3:conclusions}



\end{document}